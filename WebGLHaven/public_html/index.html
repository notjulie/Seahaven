
<!-- Licensed under a BSD license. See license.html for license -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Three.js - Fundamentals 3 cubes</title>
  </head>
  <body>
      <canvas id="c" width="800" height="800"/>
  </body>
<script type="module">
import * as THREE from './three.module.js';

function createCardShape(width, height, cornerRadius) {
    var shape = new THREE.Shape();

    shape.moveTo(0, height-cornerRadius);
    shape.arc(cornerRadius, 0, cornerRadius, Math.PI, Math.PI/2, true);
    shape.lineTo(width - cornerRadius, height);
    shape.arc(0, -cornerRadius, cornerRadius, Math.PI/2, 0, true);
    shape.lineTo(width, cornerRadius);
    shape.arc(-cornerRadius, 0, cornerRadius, 0, -Math.PI/2, true);
    shape.lineTo(cornerRadius, 0);
    shape.arc(0, cornerRadius, cornerRadius, -Math.PI/2, -Math.PI, true);

    return shape;
}

function createDiamondShape(width, height) {
    var shape = new THREE.Shape();

    shape.moveTo(width/2, 0);
    shape.lineTo(width, height/2);
    shape.lineTo(width/2, height);
    shape.lineTo(0, height/2);

    return shape;
}

function main() {
  const canvas = document.querySelector('#c');
  const renderer = new THREE.WebGLRenderer({canvas:canvas, antialias:true});

  const fov = 75;
  const aspect = 2;  // the canvas default
  const near = 0.1;
  const far = 5;
  const camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
  camera.position.z = 2;

  const scene = new THREE.Scene();

  {
    const color = 0xFFFFFF;
    const intensity = 1;
    const light = new THREE.DirectionalLight(color, intensity);
    light.position.set(-1, 2, 4);
    scene.add(light);
  }

  const boxWidth = 1;
  const boxHeight = 1;
  const boxDepth = 1;
  const geometry = new THREE.BoxGeometry(boxWidth, boxHeight, boxDepth);
  
  const planeGeometry = new THREE.PlaneGeometry(1, 2);
  
  function makeInstance(geometry, color, x) {
    const material = new THREE.MeshPhongMaterial({color});

    const cube = new THREE.Mesh(geometry, material);
    scene.add(cube);

    cube.position.x = x;

    return cube;
  }

      var cubes = [
        /*makeInstance(planeGeometry, 0x44aa88,  0)*/,
        makeInstance(planeGeometry, 0x8844aa, -2),
        /*makeInstance(geometry, 0xaa8844,  2)*/,
      ];

var cardMesh;
{
    var cardShape = createCardShape(100, 150, 10);
    var extrudeSettings = { depth: 8, bevelEnabled: true, bevelSegments: 2, steps: 2, bevelSize: 1, bevelThickness: 1 };
    var cardGeometry = new THREE.ExtrudeGeometry( cardShape, extrudeSettings );
    cardGeometry.scale(0.004, 0.004, 0.001);
 
    var mesh = new THREE.Mesh( cardGeometry, new THREE.MeshPhongMaterial() );
    //scene.add(mesh);
    //cubes[2] = mesh;
    cardMesh = mesh;
 }
 
var diamondMesh;
{
    var diamondShape = createDiamondShape(100, 150);
    var extrudeSettings = { depth: 8, bevelEnabled: true, bevelSegments: 2, steps: 2, bevelSize: 1, bevelThickness: 1 };
    var diamondGeometry = new THREE.ExtrudeGeometry( diamondShape, extrudeSettings );
    diamondGeometry.scale(0.004, 0.004, 0.001);
 
    var mesh = new THREE.Mesh( diamondGeometry, new THREE.MeshPhongMaterial({color:0xFF0000}) );
    //scene.add(mesh);
    //cubes[0] = mesh;
    diamondMesh = mesh;
 }
 
 var group = new THREE.Group();
 group.add(cardMesh);
 group.add(diamondMesh);
 diamondMesh.position.z=0.001;
 scene.add(group);
 cubes[0] = group;

      
  function render(time) {
    time *= 0.001;  // convert time to seconds

    cubes.forEach((cube, ndx) => {
      const speed = 1 + ndx * .1;
      const rot = time * speed;
      cube.rotation.x = rot;
      cube.rotation.y = rot;
    });

    renderer.render(scene, camera);

    requestAnimationFrame(render);
  }
  requestAnimationFrame(render);

}

main();
</script>
</html>
